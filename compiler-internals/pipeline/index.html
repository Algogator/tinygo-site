<!DOCTYPE html>
<html lang="en" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.52" />
    <meta name="description" content="">


    <link rel="shortcut icon" href="/tinygo-site/images/favicon.png" type="image/x-icon" />
<link rel="icon" href="/tinygo-site/images/favicon.png" type="image/x-icon" />
    <title>Pipeline :: TinyGo</title>

    
    <link href="/tinygo-site/css/nucleus.css?1545169495" rel="stylesheet">
    <link href="/tinygo-site/css/fontawesome-all.min.css?1545169495" rel="stylesheet">
    <link href="/tinygo-site/css/hybrid.css?1545169495" rel="stylesheet">
    <link href="/tinygo-site/css/featherlight.min.css?1545169495" rel="stylesheet">
    <link href="/tinygo-site/css/perfect-scrollbar.min.css?1545169495" rel="stylesheet">
    <link href="/tinygo-site/css/auto-complete.css?1545169495" rel="stylesheet">
    <link href="/tinygo-site/css/theme.css?1545169495" rel="stylesheet">
    <link href="/tinygo-site/css/hugo-theme.css?1545169495" rel="stylesheet">
    
      <link href="/tinygo-site/css/theme-blue.css?1545169495" rel="stylesheet">
    

    <script src="/tinygo-site/js/jquery-2.x.min.js?1545169495"></script>

    <style type="text/css">
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/tinygo-site/compiler-internals/pipeline/">
    <nav id="sidebar" class="">



  <div id="header-wrapper">
    <div id="header">
      <html>
<a href="https://tinygo.org"><img src="https://tinygo-org.github.io/tinygo-site/images/tinygo-logo.png">
<h4 style="color:white; margin:0;">Go compiler for small places</h4></a>
</html>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="text" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-close"></i></span>
</div>

<script type="text/javascript" src="/tinygo-site/js/lunr.min.js?1545169495"></script>
<script type="text/javascript" src="/tinygo-site/js/auto-complete.js?1545169495"></script>
<script type="text/javascript">
    
        var baseurl = "https:\/\/tinygo-org.github.io\/tinygo-site\/";
    
</script>
<script type="text/javascript" src="/tinygo-site/js/search.js?1545169495"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          


 
  
    
    <li data-nav-id="/tinygo-site/getting-started/" title="Getting Started" class="dd-item 
        
        
        
        ">
      <a href="/tinygo-site/getting-started/">
          Getting Started
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/getting-started/requirements/" title="Requirements" class="dd-item ">
        <a href="/tinygo-site/getting-started/requirements/">
        Requirements
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/getting-started/installation/" title="Installation" class="dd-item ">
        <a href="/tinygo-site/getting-started/installation/">
        Installation
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/getting-started/usage/" title="Usage" class="dd-item ">
        <a href="/tinygo-site/getting-started/usage/">
        Usage
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tinygo-site/usage/" title="Using TinyGo" class="dd-item 
        
        
        
        ">
      <a href="/tinygo-site/usage/">
          Using TinyGo
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/usage/subcommands/" title="Subcommands" class="dd-item ">
        <a href="/tinygo-site/usage/subcommands/">
        Subcommands
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/usage/important-options/" title="Important Build Options" class="dd-item ">
        <a href="/tinygo-site/usage/important-options/">
        Important Build Options
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/usage/misc-options/" title="Misc. Build Options" class="dd-item ">
        <a href="/tinygo-site/usage/misc-options/">
        Misc. Build Options
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tinygo-site/docker/" title="Using With Docker" class="dd-item 
        
        
        
        ">
      <a href="/tinygo-site/docker/">
          Using With Docker
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/docker/using/" title="Using TinyGo with Docker" class="dd-item ">
        <a href="/tinygo-site/docker/using/">
        Using TinyGo with Docker
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tinygo-site/compiler-internals/" title="Compiler Internals" class="dd-item 
        parent
        
        
        ">
      <a href="/tinygo-site/compiler-internals/">
          Compiler Internals
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/compiler-internals/differences-from-go/" title="Differences from Go" class="dd-item ">
        <a href="/tinygo-site/compiler-internals/differences-from-go/">
        Differences from Go
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/compiler-internals/datatypes/" title="Datatypes" class="dd-item ">
        <a href="/tinygo-site/compiler-internals/datatypes/">
        Datatypes
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/compiler-internals/calling-convention/" title="Calling convention" class="dd-item ">
        <a href="/tinygo-site/compiler-internals/calling-convention/">
        Calling convention
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/compiler-internals/pipeline/" title="Pipeline" class="dd-item active">
        <a href="/tinygo-site/compiler-internals/pipeline/">
        Pipeline
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          


 
  
    
    <li data-nav-id="/tinygo-site/targets/" title="Supported Targets" class="dd-item 
        
        
        
        ">
      <a href="/tinygo-site/targets/">
          Supported Targets
          
      </a>
      
      
        <ul>
          
          
          
          
        
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/targets/posix/" title="POSIX-like" class="dd-item ">
        <a href="/tinygo-site/targets/posix/">
        POSIX-like
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/targets/arm/" title="ARM / Cortex-M" class="dd-item ">
        <a href="/tinygo-site/targets/arm/">
        ARM / Cortex-M
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/targets/avr/" title="AVR" class="dd-item ">
        <a href="/tinygo-site/targets/avr/">
        AVR
        
        </a>
    </li>
     
  
 

            
          
            
            


 
  
    
      <li data-nav-id="/tinygo-site/targets/wasm/" title="WebAssembly" class="dd-item ">
        <a href="/tinygo-site/targets/wasm/">
        WebAssembly
        
        </a>
    </li>
     
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    

    
    <section id="footer">
      <center style="margin-top: -50px">Please give TinyGo a star!
    <p></p>
    <a class="github-button" href="https://github.com/aykevl/tinygo" data-icon="octicon-star" data-show-count="true" aria-label="Star TinyGo on GitHub">Star</a>
    <a class="github-button" href="https://github.com/aykevl/tinygo/fork" data-icon="octicon-repo-forked" data-show-count="true" aria-label="Fork TinyGo on GitHub">Fork</a>
    <p></p>
    <p>Site built with <a href="http://gohugo.io/">Hugo</a></p>
</center>

<script async defer src="https://buttons.github.io/buttons.js"></script>
    </section>
  </div>
</nav>





        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/tinygo-site/'>Home</a> > <a href='/tinygo-site/compiler-internals/'>Compiler Internals</a> > Pipeline
          
         
          
         
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">

    </div>
</div>

                
              </div>
            </div>
            

        
        <div id="body-inner">
          
            <h1>Pipeline</h1>
          

        


<p>Like most compilers, TinyGo is a compiler built as a pipeline of transformations, that each translate an input to a simpler output version (also called lowering). However, most of these part are not in TinyGo itself. The frontend is mostly implemented by external Go libraries, and most optimizations and code generation is implemented by LLVM.</p>

<p>This is roughly the pipeline for TinyGo:</p>

<ul>
<li>Lexing, parsing, typechecking and <a href="https://en.wikipedia.org/wiki/Abstract_syntax_tree">AST</a> building is done by
packages in the <a href="https://godoc.org/go">standard library</a> and in the <a href="https://godoc.org/golang.org/x/tools/go">golang.org/x/tools/go library</a>.</li>
<li><a href="https://en.wikipedia.org/wiki/Static_single_assignment_form">SSA</a> construction (a very important step) is done by the <a href="https://godoc.org/golang.org/x/tools/go/ssa">golang.org/x/tools/go/ssa</a> package.</li>
<li>This SSA form is then analyzed by the <a href="https://godoc.org/github.com/aykevl/tinygo/ir">ir package</a> to learn all kinds of things about the code that help the optimizer.</li>
<li>The Go SSA is then transformed into LLVM IR by the <a href="https://godoc.org/github.com/aykevl/tinygo/compiler">compiler package</a>. Both forms are SSA, but because Go SSA is higher level and contains Go-specific constructs (like interfaces and goroutines) this is non-trivial. However, the vast majority of the work is simply lowering the available Go SSA into LLVM IR, possibly calling some runtime library intrinsics in the process (for example, operations on maps).</li>
<li>This LLVM IR is then optimized by the LLVM optimizer, which has a large array of standard <a href="https://llvm.org/docs/Passes.html">optimization passes</a>. Currently, the standard optimization pipeline is used as is also be used by Clang, but a pipeline better tuned for TinyGo might be used in the future.</li>
<li>After all optimizations have run, a few fixups are needed for AVR for globals. This is implemented by the compiler package.</li>
<li>Finally, the resulting machine code is emitted by LLVM to an object file, to be linked by an architecture-specific linker in a later step.</li>
</ul>

<p>After this whole list of compiler phases, the Go source has been transformed into object code. It can then be emitted directly to a file (for linking in a different build system), or it can be linked directly or even be flashed to a target by TinyGo (using external tools under the hood).</p>


<footer class=" footline" >
	
</footer>


        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/tinygo-site/compiler-internals/calling-convention/" title="Calling convention"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/tinygo-site/targets/" title="Supported Targets" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/tinygo-site/js/clipboard.min.js?1545169495"></script>
    <script src="/tinygo-site/js/perfect-scrollbar.min.js?1545169495"></script>
    <script src="/tinygo-site/js/perfect-scrollbar.jquery.min.js?1545169495"></script>
    <script src="/tinygo-site/js/jquery.sticky.js?1545169495"></script>
    <script src="/tinygo-site/js/featherlight.min.js?1545169495"></script>
    <script src="/tinygo-site/js/html5shiv-printshiv.min.js?1545169495"></script>
    <script src="/tinygo-site/js/highlight.pack.js?1545169495"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/tinygo-site/js/modernizr.custom.71422.js?1545169495"></script>
    <script src="/tinygo-site/js/learn.js?1545169495"></script>
    <script src="/tinygo-site/js/hugo-learn.js?1545169495"></script>

    <link href="/tinygo-site/mermaid/mermaid.css?1545169495" type="text/css" rel="stylesheet" />
    <script src="/tinygo-site/mermaid/mermaid.js?1545169495"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    

  </body>
</html>

